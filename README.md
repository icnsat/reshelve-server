# üìö Reshelve - server

–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –∫–Ω–∏–∂–Ω–æ–π –ø–æ–ª–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ù–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ Node.js —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Express –∏ PostgreSQL.

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ–π –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π: –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–∏—Å Neon.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–µ Vercel. 

> [!NOTE]  
> Frontend-—á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ª–µ–∂–∏—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ [reshelve-client](https://github.com/icnsat/reshelve-client).  

### –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ API

- –û–±—â–∏–µ
  - `GET`       `/` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞.
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  - `POST`      `/auth/login` - –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `POST`      `/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ö–Ω–∏–≥–∏
  - `GET`       `/books` - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–Ω–∏–≥.
  - `POST`      `/books` - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É.
  - `GET`       `/books/:id` - –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ.
  - `PUT`       `/books/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ.
  - `DELETE`    `/books/:id` - –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É.
- –ü–æ–ª–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `GET`       `/bookshelf` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `POST`      `/bookshelf` - –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É –Ω–∞ –ø–æ–ª–∫—É.
  - `GET`       `/bookshelf/:id` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–µ –Ω–∞ –ø–æ–ª–∫–µ.
  - `DELETE`    `/bookshelf/:id` - –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É —Å –ø–æ–ª–∫–∏.
- –ó–∞–º–µ—Ç–∫–∏ –¥–ª—è –∫–Ω–∏–≥
  - `GET`       `/bookshelf/:bookshelfId/comments` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏ —É –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `POST`      `/bookshelf/:bookshelfId/comments` - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –∫ –∫–Ω–∏–≥–µ –Ω–∞ –ø–æ–ª–∫–µ.
  - `PATCH`     `/bookshelf/:bookshelfId/comments/:id` - –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É —É –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `DELETE`    `/bookshelf/:bookshelfId/comments/:id` - –£–¥–∞–ª–∏—Ç—å –∑–∞–º–µ—Ç–∫—É —É –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
- –õ–æ–≥–∏ —á—Ç–µ–Ω–∏—è
  - `GET`       `/bookshelf/:bookshelfId/logs` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ –¥–ª—è –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `POST`      `/bookshelf/:bookshelfId/logs` - –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥ –∫ –∫–Ω–∏–≥–µ –Ω–∞ –ø–æ–ª–∫–µ.
  - `PUT`       `/bookshelf/:bookshelfId/logs/:id` - –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥ —É –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `DELETE`    `/bookshelf/:bookshelfId/logs/:id` - –£–¥–∞–ª–∏—Ç—å –ª–æ–≥ —É –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
- –¢–µ–≥–∏ –¥–ª—è –∫–Ω–∏–≥
  - `GET`       `/tags` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ (—Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ).
  - `POST`      `/tags` - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–µ–≥ (—Å–∏—Å—Ç–µ–º–Ω—ã–π –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π).
  - `PUT`       `/tags/:tagId` - –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–≥.
  - `DELETE`    `/tags/:tagId` - –£–¥–∞–ª–∏—Ç—å —Ç–µ–≥.

  - `GET`       `/bookshelf/:bookshelfId/tags` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ –¥–ª—è –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `POST`      `/bookshelf/:bookshelfId/tags` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–≥–æ–≤ –¥–ª—è –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.
  - `DELETE`    `/bookshelf/:bookshelfId/tags/:tagId` - –£–¥–∞–ª–µ–Ω–∏–µ —Ç–µ–≥–∞ –¥–ª—è –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫–µ.

–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É—é—Ç –Ω–∞–ª–∏—á–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞.
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ frontend-—á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–æ–∫–µ–Ω –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –æ–¥–Ω–∞–∫–æ –∑–∞–ø—Ä–æ—Å—ã –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏ –≤—Ä—É—á–Ω—É—é, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ:

```sh
# –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
curl -X POST http://localhost:5000/auth/login \
-H "Content-Type: application/json" \
-d '{
  "email": "icnsat@icn.sat",
  "password": "******
}'

# –û—Ç–≤–µ—Ç
{"token":"eyJhbGciOiJI.F0IjoiOjE3NDYwMjYzMzF9.vweNcisXCb0YktvbWMs"}

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥—É –Ω–∞ –ø–æ–ª–∫—É
curl -X POST http://localhost:5000/bookshelf \
-H "Content-Type: application/json" \
-H "Authorization: Bearer eyJhbGciOiJI.F0IjoiOjE3NDYwMjYzMzF9.vweNcisXCb0YktvbWMs" \
-d '{
  "book_id": "2"
}'

# –û—Ç–≤–µ—Ç
{
    "id": 2,
    "message": "Book added to bookshelf"
}
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:

```sh
npm i
```

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã Node JS, PostgreSQL –∏ `.env` —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞. –ü—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞:

```ini
# JWT
SECRET_KEY=:)

# Database
LOCAL=true

LOCAL_DATABASE_URL=postgresql://localhost/reshelve
REMOTE_DATABASE_URL=postgres://user:privatecode.aws.neon.tech/neondb?sslmode=require

# Export app for Vercel or run on PORT
VERCEL=false
PORT=5000
```

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É:

```sh
npm start
```
